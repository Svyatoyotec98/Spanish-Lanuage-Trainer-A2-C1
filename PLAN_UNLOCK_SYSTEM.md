# План работ: Система разблокировки тестов

## Общая концепция
Кнопка "Пройти тест" по умолчанию **заблокирована**. Для разблокировки нужно просмотреть материал.

---

## 1. PALABRAS (Слова)

### 1.1 Блокировка кнопки "Пройти тест"
- В `groupPreviewMenu` кнопка "Пройти тест" по умолчанию серая/заблокированная
- Проверять в localStorage/profile флаг `wordsViewed[unidad][group] = true`

### 1.2 Просмотр словаря (miniDictionaryScreen)
- Отслеживать скролл до конца списка слов
- Когда пользователь долистал до последнего слова:
  - Показать кнопку **"Перейти к тесту"** внизу (рядом с "Назад к группе")
  - Записать флаг `wordsViewed[unidad][group] = true`

### 1.3 Кнопка "Перейти к тесту" в словаре
- Появляется только после просмотра всех слов
- При нажатии:
  - Если группа **≥10 слов** → переход в `categoryMenu` (выбор сложности)
  - Если группа **<10 слов** → сразу `startCardMatchingGame()`

### 1.4 После просмотра
- Кнопка "Пройти тест" в `groupPreviewMenu` **разблокируется навсегда**
- Даже если тест не пройден - кнопка остаётся разблокированной

---

## 2. EJERCICIOS (Грамматика)

### 2.1 Блокировка кнопки "Пройти тест"
- В `exercisePreviewMenu` кнопка "Пройти тест" по умолчанию заблокирована
- Проверять флаг `ruleViewed[unidad][exerciseId] = true`

### 2.2 Просмотр правила (grammarRuleScreen)
- Показывать правило с примерами
- Кнопка "Проверь себя" → микро-тесты

### 2.3 Микро-тесты (microTestsScreen)
- После успешного прохождения всех микро-тестов:
  - Показать сообщение "Все микро-тесты пройдены!"
  - Показать кнопку **"Перейти к тесту"** в правом нижнем углу
  - Записать флаг `ruleViewed[unidad][exerciseId] = true`

### 2.4 Layout кнопок в microTestsScreen
- **Левый нижний угол**: "← Назад к правилу"
- **Правый нижний угол**: "Проверь себя" → после прохождения меняется на "Перейти к тесту →"

### 2.5 После прохождения микро-тестов
- Кнопка "Пройти тест" в `exercisePreviewMenu` **разблокируется**

---

## 3. UI/UX улучшения

### 3.1 Увеличить шрифт в Ejercicios на 35%
- `grammarRuleScreen` - текст правила и примеры
- `microTestsScreen` - предложения и поля ввода

### 3.2 Layout кнопок
- Везде: "Назад" слева, основное действие справа
- Использовать `display: flex; justify-content: space-between;`

---

## 4. Структура данных (profile)

```javascript
profile.progress[unidad] = {
    // Существующие поля...

    // Новые поля для разблокировки:
    wordsViewed: {
        'FAMILIA': true,
        'IDIOMAS_APRENDIZAJE': false,
        // ...
    },
    rulesViewed: {
        'preposiciones_con_en_entre': true,
        // ...
    }
}
```

---

## 5. Порядок реализации

### Этап 1: Palabras
1. [ ] Добавить поле `wordsViewed` в profile
2. [ ] Заблокировать кнопку "Пройти тест" в groupPreviewMenu
3. [ ] Добавить отслеживание скролла в miniDictionaryScreen
4. [ ] Добавить кнопку "Перейти к тесту" (появляется после просмотра)
5. [ ] Разблокировать кнопку после просмотра

### Этап 2: Ejercicios
1. [ ] Добавить поле `rulesViewed` в profile
2. [ ] Заблокировать кнопку "Пройти тест" в exercisePreviewMenu
3. [ ] Изменить layout кнопок в microTestsScreen
4. [ ] Добавить кнопку "Перейти к тесту" после микро-тестов
5. [ ] Разблокировать кнопку после прохождения микро-тестов

### Этап 3: UI
1. [ ] Увеличить шрифт в grammarRuleScreen на 35%
2. [ ] Увеличить шрифт в microTestsScreen на 35%
3. [ ] Унифицировать layout кнопок везде

---

## Файлы для изменения
- `js/app.js` - логика разблокировки, отслеживание скролла
- `index.html` - добавить скрытые кнопки "Перейти к тесту"
- `css/Styles.css` - стили для заблокированных кнопок

---

*Создано: 2026-01-06*
*Ветка: claude/continue-session-work-OyFDK*
